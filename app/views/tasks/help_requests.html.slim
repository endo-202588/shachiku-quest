.container.mx-auto.px-4.py-8
  h1.text-4xl.font-bold.text-sky-900.mb-4.flex.items-center.justify-center.w-full.gap-1
    | ã‚·ãƒ£ãƒãƒ¼ã‚¯ã®çµ¦æ¹¯å®¤

  - full_text = "ã“ã‚“ã«ã¡ã¯ï¼ã‚·ãƒ£ãƒãƒ¼ã‚¯ã®çµ¦æ¹¯å®¤ã¸ã‚ˆã†ã“ãã€‚[br]ãŠã‚„ã€ãŠä»•äº‹ãŒã„ã£ã±ã„ã„ã£ã±ã„ã§ã™ã‹ï¼Ÿãã‚Œã¨ã‚‚äººåŠ©ã‘ã‚’ã—ã¦å¾³ã‚’ç©ã¿ãŸã„ï¼Ÿ [br]ã“ã“ã¯åŠ©ã‘ã¦ã»ã—ã„å‹‡è€…ã¨èª°ã‹ã®åŠ›ã«ãªã‚ŠãŸã„å‹‡è€…ã®æ©‹æ¸¡ã—ã‚’ã™ã‚‹å ´æ‰€ã€‚[br]ãƒ»é­”æ³•ï¼ˆãŠæ‰‹ä¼ã„ã§ãã‚‹æ™‚é–“ï¼‰ã‚’ç™»éŒ²ã™ã‚‹ã¨ã€ãƒ˜ãƒ«ãƒ‘ãƒ¼ã«ãªã‚Œã¾ã™[br]ãƒ»ãŠæ‰‹ä¼ã„ã‚’é ¼ã¿ãŸã„æ–¹ã¯ã€ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’ä»²é–“ã«ã™ã‚‹ã“ã¨ã§ãŠæ‰‹ä¼ã„ã‚’é ¼ã‚€ã“ã¨ãŒã§ãã¾ã™"
  - full_text_render = full_text.gsub("[br]", "\n")

  .div.mt-6.mb-8
    .mx-auto.max-w-3xl
      .message-window.rounded-xl.bg-black/65.px-6.py-4.text-white.shadow-md.shadow-black/30.ring-2.ring-white/80(
        data-controller="typewriter-fixed"
        data-typewriter-fixed-speed-value="35"
        data-typewriter-fixed-start-delay-value="200"
      )
        .grid.whitespace-pre-wrap.text-base.leading-relaxed.font-semibold.tracking-wide
          / é«˜ã•ç¢ºä¿ï¼ˆæœ€çµ‚å½¢ã‚’ invisible ã§é…ç½®ï¼‰
          .invisible.col-start-1.row-start-1.whitespace-pre-wrap(
            aria-hidden="true"
            data-typewriter-fixed-target="measure"
          )= full_text_render

          / è¡¨ç¤ºç”¨ï¼ˆã“ã“ã«ã‚¿ã‚¤ãƒ—ã•ã‚Œã‚‹ï¼‰
          .col-start-1.row-start-1.z-10.whitespace-pre-wrap(
            data-typewriter-fixed-target="out"
          )
  .mb-6
    h4.font-bold.mb-2 ã€æ³¨æ„ã€‘
    ul class="list-disc list-inside" style="padding-left: 20px;"
      li.mb-1 åŠ©ã‘åˆã„ã¯ãã®æ—¥ã®ã¿ã§ã™ã€‚ç¿Œæ—¥ã«ãªã‚‹ã¨ãƒãƒƒãƒãƒ³ã‚°ä¸­ã§ã‚‚è‡ªå‹•çš„ã«ãƒãƒƒãƒãƒ³ã‚°ã¯è§£é™¤ã•ã‚Œã¾ã™ã€‚
      li å®Œäº†é€šçŸ¥æ¸ˆã¿ã®ãƒ˜ãƒ«ãƒ—è¦è«‹ã‚¿ã‚¹ã‚¯ã¯ã€ç™ºæ³¨è€…ãŒå®Œäº†ã«ã—ãªã‹ã£ãŸå ´åˆã§ã‚‚ç¿Œæ—¥è‡ªå‹•çš„ã«å®Œäº†ã¨ãªã‚Šã€å¾³ãƒã‚¤ãƒ³ãƒˆãŒãƒ˜ãƒ«ãƒ‘ãƒ¼ã«ä»˜ä¸ã•ã‚Œã¾ã™ã€‚

  .mb-3
    - if current_user.help_magic.present?
      .bg-white.rounded-xl.shadow-md.p-4.mb-4
        .flex.items-center.justify-between.gap-4
          / å·¦å´ï¼šé­”æ³•ãƒ†ã‚­ã‚¹ãƒˆ
          .flex.items-center.gap-2.text-lg.text-sky-800.font-bold.min-w-0
            = current_user.help_magic.decorate.help_magic_text

          / å³å´ï¼šæ“ä½œã‚¨ãƒªã‚¢ï¼ˆâ†å¿…ãšã“ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã§â€œå³å´â€ã«å…¥ã‚Œã‚‹ï¼‰
          .flex.items-center.gap-3.shrink-0
            - if current_user.can_edit_help_magic?
              = link_to edit_help_magic_path(return_to: request.fullpath),
                  class: "inline-flex items-center gap-1 px-3 py-2 rounded-md text-sm font-bold bg-blue-600 text-white hover:bg-blue-700 transition" do
                / svg ...
                span ç·¨é›†
            - else
              span.text-slate-500.text-sm ãƒãƒƒãƒä¸­ã®ãŸã‚ç·¨é›†ä¸å¯

            - if current_user.can_delete_help_magic?
              = button_to help_magic_path,
                  method: :delete,
                  form: { class: "inline-block m-0" },
                  data: { turbo_confirm: "é­”æ³•ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ" },
                  class: "inline-flex items-center gap-1 px-3 py-2 rounded-md text-sm font-bold bg-red-600 text-white hover:bg-red-700 transition" do
                / svg ...
                span å‰Šé™¤
            - else
              span.text-slate-500.text-sm ãƒãƒƒãƒä¸­ã®ãŸã‚å‰Šé™¤ä¸å¯
    - else
      .mb-6
        = link_to 'âœ¨ é­”æ³•ã‚’ç™»éŒ²ã™ã‚‹',
          new_help_magic_path,
          class: 'inline-block px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition'

  / ========== ãƒ˜ãƒ«ãƒ‘ãƒ¼ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ ==========
  .mb-8
    h2.text-xl.font-semibold.mb-4.border-b.pb-2 ãƒ˜ãƒ«ãƒ‘ãƒ¼ç™»éŒ²æ¸ˆã¿ã®å‹‡è€…
    - if @helpers.present?
      .grid.grid-cols-1.md:grid-cols-2.lg:grid-cols-3.gap-4
        - @helpers.each do |helper|
          .bg-blue-50.rounded-lg.p-4.border.border-blue-200
            .flex.items-center.gap-3
              / ã‚¢ã‚¤ã‚³ãƒ³éƒ¨åˆ†
              .w-10.h-10.bg-blue-500.rounded-full.flex.items-center.justify-center.text-white.font-bold
                = helper.last_name.to_s[0]

              / åå‰è¡¨ç¤º(UserDecoratorã®full_nameã‚’ä½¿ç”¨)
              .flex-1
                p.font-bold.text-lg = helper.full_name

              / å¿…è¦æ™‚é–“(TaskDecoratorã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨)
              - if helper.available_time_with_icon
                .ml-auto
                  = helper.available_time_with_icon
            .mt-3
              - if current_user&.id == helper.id
                .block.w-full.text-center.bg-gray-400.text-white.font-bold.py-2.px-4.rounded
                  | ğŸ§¹ ã‚ãªãŸã§ã™
              - elsif helper.helping_now?(@matching_helper_ids)
                .block.w-full.text-center.bg-gray-400.text-white.font-bold.py-2.px-4.rounded
                  | ğŸ§¹ ãŠæ‰‹ä¼ã„ä¸­
              - else
                = link_to select_task_helper_path(helper),
                          class: 'block w-full text-center bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-200' do
                  | ğŸ¤ ä»²é–“ã«åŠ ãˆã‚‹
    - else
      .bg-gray-100.rounded-lg.p-6.text-center.text-gray-600
        p ç¾åœ¨åˆ©ç”¨å¯èƒ½ãªãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯ã„ã¾ã›ã‚“

  / ========== ã‚¿ã‚¹ã‚¯ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ ==========
  .mb-8
    / è¦‹å‡ºã—ã¨ãƒœã‚¿ãƒ³ã‚’æ¨ªä¸¦ã³ã«é…ç½®
    .flex.justify-between.items-center.mb-4.border-b.pb-2
      h2.text-xl.font-semibold ä¸€ç·’ã«æˆ¦ã£ã¦ã»ã—ã„ã‚¿ã‚¹ã‚¯
    - if @tasks.present?
      .space-y-4
        - @tasks.each do |task|
          .bg-white.p-6.border-gray-600.border-2.shadow-sm
            / ã‚¿ã‚¹ã‚¯æƒ…å ±
            .flex.justify-between.items-start.mb-3
              .flex-1
                h3.font-bold.text-lg.mb-2 = task.title
                - if task.object.description.present?
                  .bg-yellow-50.rounded.p-3.mb-3
                    p.text-sm.text-gray-600.mt-1
                      = task.object.description

              / ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸(TaskDecoratorã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨)
              .ml-4
                = task.status_badge_html

            / ã‚¿ã‚¹ã‚¯ã®è©³ç´°æƒ…å ±
            .flex.gap-6.text-sm.text-gray-600.mb-3
              / ãƒ¦ãƒ¼ã‚¶ãƒ¼å(UserDecoratorã®full_nameã‚’ä½¿ç”¨)
              .flex.items-center.gap-1
                i.fas.fa-user
                = task.user.decorate.full_name

              / å¿…è¦æ™‚é–“(TaskDecoratorã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨)
              - if task.required_time_with_icon
                = task.required_time_with_icon

              p.text-gray-700 = task.help_request_status_html

            .flex.gap-2.justify-end
              - if current_user&.helper?
                - if task.user_id == current_user.id
                  .px-4.py-2.bg-gray-200.text-gray-600.rounded.text-sm
                    | ğŸ™… è‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯ã§ã™
                - elsif task.user_id != current_user.id && task.help_request&.open? && task.help_request.helper_id.nil?
                  = button_to 'ğŸ¤ ã“ã®ä»•äº‹ã®ä»²é–“ã«ãªã‚‹',
                    apply_help_request_path(task.help_request),
                    method: :post,
                    data: { turbo: false },
                    class: 'px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition'
                - else
                  .px-4.py-2.bg-gray-400.text-white.rounded.text-sm
                    | ğŸ§¹ å‹Ÿé›†çµ‚äº†
              - else
                - if task.user_id == current_user.id
                  .px-4.py-2.bg-gray-200.text-gray-600.rounded.text-sm
                    | ğŸ™… è‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯ã§ã™
                - elsif task.help_request&.open? && task.help_request.helper_id.nil?
                  = link_to 'é­”æ³•ã‚’ç™»éŒ²ã—ã¦å¿œå‹Ÿ', new_help_magic_path,
                    class: 'px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition'

    - else
      .bg-gray-100.rounded-lg.p-6.text-center.text-gray-600
        p ç¾åœ¨ãƒ˜ãƒ«ãƒ—è¦è«‹ã¯ã‚ã‚Šã¾ã›ã‚“
