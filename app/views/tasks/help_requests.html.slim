.container.mx-auto.px-4.py-8
  h1.text-4xl.font-bold.text-sky-900.mb-4.flex.items-center.justify-center.w-full.gap-1
    | ã‚·ãƒ£ãƒãƒ¼ã‚¯ã®çµ¦æ¹¯å®¤

  - full_text = "ã“ã‚“ã«ã¡ã¯ï¼ã‚·ãƒ£ãƒãƒ¼ã‚¯ã®çµ¦æ¹¯å®¤ã¸ã‚ˆã†ã“ãã€‚[br]ãŠã‚„ã€ãŠä»•äº‹ã„ã£ã±ã„ã„ã£ã±ã„ã§ã™ã‹ï¼Ÿãã‚Œã¨ã‚‚äººåŠ©ã‘ã‚’ã—ã¦å¾³ã‚’ç©ã¿ãŸã„æ–¹ï¼Ÿ [br]ã“ã“ã¯åŠ©ã‘ã¦ã‚‚ã‚‰ã„ãŸã„å‹‡è€…ã¨åŠ©ã‘ãŸã„å‹‡è€…ã®æ©‹æ¸¡ã—ã‚’ã™ã‚‹å ´æ‰€ã€‚[br]ãƒ»é­”æ³•ï¼ˆãŠæ‰‹ä¼ã„ã§ãã‚‹æ™‚é–“ï¼‰ã‚’ç™»éŒ²ã™ã‚‹ã¨ã€ãƒ˜ãƒ«ãƒ‘ãƒ¼ã«ãªã‚Œã¾ã™[br]ãƒ»ãŠæ‰‹ä¼ã„ã‚’é ¼ã¿ãŸã„æ–¹ã¯ã€ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’ä»²é–“ã«ã™ã‚‹ã“ã¨ã§ãŠæ‰‹ä¼ã„ã‚’é ¼ã‚€ã“ã¨ãŒã§ãã¾ã™"
  - full_text_render = full_text.gsub("[br]", "\n")

  .div.mt-6.mb-8
    .mx-auto.max-w-3xl
      .message-window.rounded-xl.bg-black/65.px-6.py-4.text-white.shadow-md.shadow-black/30.ring-2.ring-white/80(
        data-controller="typewriter-fixed"
        data-typewriter-fixed-speed-value="35"
        data-typewriter-fixed-start-delay-value="200"
      )
        .grid.whitespace-pre-wrap.text-base.leading-relaxed.font-semibold.tracking-wide
          / é«˜ã•ç¢ºä¿ï¼ˆæœ€çµ‚å½¢ã‚’ invisible ã§é…ç½®ï¼‰
          .invisible.col-start-1.row-start-1.whitespace-pre-wrap(
            aria-hidden="true"
            data-typewriter-fixed-target="measure"
          )= full_text_render

          / è¡¨ç¤ºç”¨ï¼ˆã“ã“ã«ã‚¿ã‚¤ãƒ—ã•ã‚Œã‚‹ï¼‰
          .col-start-1.row-start-1.z-10.whitespace-pre-wrap(
            data-typewriter-fixed-target="out"
          )

  .mb-3
    - if current_user.help_magic.present?
      .bg-white.rounded-xl.shadow-md.p-4.mb-4
        .flex.justify-between.items-center
          / å·¦å´ï¼šé­”æ³•ãƒ†ã‚­ã‚¹ãƒˆ
          .flex.items-center.gap-2.text-lg.text-sky-800.font-bold
            = current_user.help_magic.decorate.help_magic_text

          / å³å´ï¼šå‰Šé™¤ãƒœã‚¿ãƒ³
          - if current_user.can_delete_help_magic?
            .flex.items-center.gap-3
              = link_to edit_help_magic_path(return_to: request.fullpath),
                  class: 'flex items-center gap-1 text-sky-700 hover:text-sky-900 font-bold text-base px-2 py-1 transition bg-transparent' do
                svg.h-5.w-5 stroke="currentColor" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke-width="2"
                  path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"
                span ç·¨é›†

              = button_to help_magic_path,
                  method: :delete,
                  data: { turbo_confirm: 'é­”æ³•ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ' },
                  class: 'flex items-center gap-1 text-red-600 hover:text-red-800 font-bold text-base px-2 py-1 transition bg-transparent' do
                svg.h-6.w-6 stroke="currentColor" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"
                  path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                span å‰Šé™¤

  .mb-6
    - if current_user.help_magic.blank?
      = link_to 'âœ¨ é­”æ³•ã‚’ç™»éŒ²ã™ã‚‹',
        new_help_magic_path,
        class: 'inline-block px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition'

  / ========== ãƒ˜ãƒ«ãƒ‘ãƒ¼ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ ==========
  .mb-8
    h2.text-xl.font-semibold.mb-4.border-b.pb-2 ãƒ˜ãƒ«ãƒ‘ãƒ¼ç™»éŒ²æ¸ˆã¿ã®å‹‡è€…
    - if @helpers.present?
      .grid.grid-cols-1.md:grid-cols-2.lg:grid-cols-3.gap-4
        - @helpers.each do |helper|
          .bg-blue-50.rounded-lg.p-4.border.border-blue-200
            .flex.items-center.gap-3
              / ã‚¢ã‚¤ã‚³ãƒ³éƒ¨åˆ†
              .w-10.h-10.bg-blue-500.rounded-full.flex.items-center.justify-center.text-white.font-bold
                = helper.last_name[0]

              / åå‰è¡¨ç¤º(UserDecoratorã®full_nameã‚’ä½¿ç”¨)
              .flex-1
                p.font-bold.text-lg = helper.full_name

              / å¿…è¦æ™‚é–“(TaskDecoratorã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨)
              - if helper.available_time_with_icon
                .ml-auto
                  = helper.available_time_with_icon
            .mt-3
              - if current_user&.id == helper.id
                .block.w-full.text-center.bg-gray-400.text-white.font-bold.py-2.px-4.rounded
                  | ğŸ§¹ ã‚ãªãŸã§ã™
              - elsif helper.helping_now?
                .block.w-full.text-center.bg-gray-400.text-white.font-bold.py-2.px-4.rounded
                  | ğŸ§¹ ãŠæ‰‹ä¼ã„ä¸­
              - else
                = link_to select_task_helper_path(helper),
                          class: 'block w-full text-center bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-200' do
                  | ğŸ¤ ä»²é–“ã«åŠ ãˆã‚‹
    - else
      .bg-gray-100.rounded-lg.p-6.text-center.text-gray-600
        p ç¾åœ¨åˆ©ç”¨å¯èƒ½ãªãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯ã„ã¾ã›ã‚“

  / ========== ã‚¿ã‚¹ã‚¯ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ ==========
  .mb-8
    / è¦‹å‡ºã—ã¨ãƒœã‚¿ãƒ³ã‚’æ¨ªä¸¦ã³ã«é…ç½®
    .flex.justify-between.items-center.mb-4.border-b.pb-2
      h2.text-xl.font-semibold ä¸€ç·’ã«æˆ¦ã£ã¦ã»ã—ã„ã‚¿ã‚¹ã‚¯
    - if @tasks.present?
      .space-y-4
        - @tasks.each do |task|
          .bg-white.p-6.border-gray-600.border-2.shadow-sm
            / ã‚¿ã‚¹ã‚¯æƒ…å ±
            .flex.justify-between.items-start.mb-3
              .flex-1
                h3.font-bold.text-lg.mb-2 = task.title
                - if task.object.description.present?
                  .bg-yellow-50.rounded.p-3.mb-3
                    p.text-sm.text-gray-600.mt-1
                      = task.object.description

              / ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸(TaskDecoratorã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨)
              .ml-4
                = task.status_badge_html

            / ã‚¿ã‚¹ã‚¯ã®è©³ç´°æƒ…å ±
            .flex.gap-6.text-sm.text-gray-600.mb-3
              / ãƒ¦ãƒ¼ã‚¶ãƒ¼å(UserDecoratorã®full_nameã‚’ä½¿ç”¨)
              .flex.items-center.gap-1
                i.fas.fa-user
                = task.user.decorate.full_name

              / å¿…è¦æ™‚é–“(TaskDecoratorã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨)
              - if task.required_time_with_icon
                = task.required_time_with_icon

              p.text-gray-700 = task.help_request_status_html

            .flex.gap-2.justify-end
              - if current_user&.helper?
                - if task.user_id == current_user.id
                  .px-4.py-2.bg-gray-200.text-gray-600.rounded.text-sm
                    | ğŸ™… è‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯ã§ã™
                - elsif task.user_id != current_user.id && task.help_request&.open? && task.help_request.helper_id.nil?
                  = button_to 'ğŸ¤ ã“ã®ä»•äº‹ã®ä»²é–“ã«ãªã‚‹',
                    apply_help_request_path(task.help_request),
                    method: :post,
                    data: { turbo: false },
                    class: 'px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition'
                - else
                  .px-4.py-2.bg-gray-400.text-white.rounded.text-sm
                    | ğŸ§¹ å‹Ÿé›†çµ‚äº†
              - else
                - if task.user_id == current_user.id
                  .px-4.py-2.bg-gray-200.text-gray-600.rounded.text-sm
                    | ğŸ™… è‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯ã§ã™
                - elsif task.help_request&.open? && task.help_request.helper_id.nil?
                  = link_to 'é­”æ³•ã‚’ç™»éŒ²ã—ã¦å¿œå‹Ÿ', new_help_magic_path,
                    class: 'px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition'

    - else
      .bg-gray-100.rounded-lg.p-6.text-center.text-gray-600
        p ç¾åœ¨ãƒ˜ãƒ«ãƒ—è¦è«‹ã¯ã‚ã‚Šã¾ã›ã‚“
